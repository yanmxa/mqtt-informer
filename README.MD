# MQTT Informer

## Description
This is a simple MQTT client that can be used to publish messages to a broker and subscribe to topics.


## Send resource from agent apiserver to broker
- List
```json
{
  "type": "list.v1.secrets.",
  "id": "1",
  "source": "manager",
  "payload": "eyJuYW1lc3BhY2UiOiJkZWZhdWx0In0="
}
```
- Watch
```json
{
  "type": "watch.v1.secrets.",
  "id": "1",
  "source": "manager",
  "payload": "eyJuYW1lc3BhY2UiOiJkZWZhdWx0In0="
}
```

## Receive resource from mqtt broker to apiserver
- List
```json
{
  "type": "response.list.v1.secrets.",
  "id": "1",
  "source": "manager",
  "payload": "eyJvYmplY3RzIjp7ImFwaVZlcnNpb24iOiJ2MSIsIml0ZW1zIjpbeyJhcGlWZXJzaW9uIjoidjEiLCJkYXRhIjp7ImNhLmNydCI6IkxTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVU12YWtORFFXVmhaMEYzU1VKQlowbENRVVJCVGtKbmEzRm9hMmxIT1hjd1FrRlJjMFpCUkVGV1RWSk5kMFZSV1VSV1VWRkVSWGR3Y21SWFNtd0tZMjAxYkdSSFZucE5RalJZUkZSSmVrMUVXWGxOUkVFMFRWUkZlVTVzYjFoRVZFMTZUVVJaZUU1NlFUUk5WRVY1VG14dmQwWlVSVlJOUWtWSFFURlZSUXBCZUUxTFlUTldhVnBZU25WYVdGSnNZM3BEUTBGVFNYZEVVVmxLUzI5YVNXaDJZMDVCVVVWQ1FsRkJSR2RuUlZCQlJFTkRRVkZ2UTJkblJVSkJURTAxQ2tSWWN6VjNhUzk1V0dGbE1teExjRkpWZEhkeU1ETkVkRTl1U2taU1duTlBVMWRQVERSVmRVSkRjamhMZGlzMk5rbEtMeXRoVlhkMFNFZFlTMEkyTWtFS1RESkNkRzV2V0VWVFZXaEJSRzk0T1ZSclEyMTVjV2RhVjFrd2N6TlpXWFZsTUdKd01sSnNWRGh0VDNSMVZtMVpZVk01ZGt0MVExTlBlRUpFVGpGMlR3cHRUR2h3TjNSRVdWcDRSV1ZxWjNWaGJTdFJVbUpFVW1KTGFpOVVVR0prTjJsdGFtZDBTM04yTVVoMU16VXhVRzlXYTBOVFFuVjZTR05YYW1GU2JtZGhDbVoyS3pRcldWUktNMHd6TVVwQlJtdENWMmQ1UWpWemQycGFiVUpyWlVsSk4ycE5UVlJ2T0VJNUwxSmFXVEpoUTFVcmNreDBja2Q1ZFhGSlFVWnBjMWNLVVRVMGRYSk5lRzF6YUZKMFZERndUblpOY2sxRk5VNTBlV2xEYkU1MWRFdFBhakJvVWxaelRXNHpkVzlqTmk5cldta3lVbFI0TUdWMWVrTXlUR2hxTWdwaEwyVXhka3hZTUZkclJrOXhXbXBXZDI4NFEwRjNSVUZCWVU1YVRVWmpkMFJuV1VSV1VqQlFRVkZJTDBKQlVVUkJaMHRyVFVFNFIwRXhWV1JGZDBWQ0NpOTNVVVpOUVUxQ1FXWTRkMGhSV1VSV1VqQlBRa0paUlVaTGRYcGpWR1pEUm00emRtMXNVbmwzUTFKdU5rRmlNM1puSzFCTlFsVkhRVEZWWkVWUlVVOEtUVUY1UTBOdGRERlpiVlo1WW0xV01GcFlUWGRFVVZsS1MyOWFTV2gyWTA1QlVVVk1RbEZCUkdkblJVSkJTVWRNT1ZoWmRHcFVZbWRDZHpKUlkyMUtRZ3B0VkZwMk1tWkNkM0JCVVVKSlpVazFUelZLUW1GMlMzUkJPWEphVUdka1pqQjNVelJRVDJGc1dGUm5ZVFp2WXpGeU4zYzRLMWd5Um1rMWJsTllPRlZHQ21ReGJsUjRXblZ1Y2sxSlVVWndPR296ZDB0NVoyZFlaMU56U2s5b1FXbHNUREJXUWxac1kySXdZbkpWWmpsT1lVTkNjREkwTlZGTFJUZFZkelIwUVM4S2NVcG9Ra1F3VUhRMU5HeHNZVkZvY21ScWJVNVVOMHhZUTJzMVVEUlllVFpyWXl0aFZWTlRUemxVYWtZM1ZFNTVNRkl3VVhWb01ESk9hRTlrUVRKNVFncENVMGs1Y0hZNWJVd3daV3hYVjNwVEwwaHhUWGxNVEZORFRrRmxSbVJrY0ZWUVVHMHhlR2RhU21zNE9YRnNjU3RFYzJSeGFFbDRUa3RhYnpkc2FGTndDa2hwZFd4MEsyMWFTa2R1YkdaWVZ6SmxTa1pSWWsxalNESlphbmxTWlRSeFpXVmlka2N4UlZWeWFWaEVVVVpzUWpGeVRVUndPRzlPUzJkMWFtdzVlVUVLWWtSWlBRb3RMUzB0TFVWT1JDQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENnPT0iLCJuYW1lc3BhY2UiOiJaR1ZtWVhWc2RBPT0iLCJ0b2tlbiI6IlpYbEthR0pIWTJsUGFVcFRWWHBKTVU1cFNYTkpiWFJ3V2tOSk5rbHNjRXRUUkVrMVlXeFdjbU13U2pKUFIzaHlVekZzV0ZneWJ6Tk5Nbmd3WW01dk1tTnJSWHBpTW1oYVVsZHdNVmRYYXpWV01UbHZXbTVOYVdaUkxtVjVTbkJqTTAxcFQybEtjbVJYU214amJUVnNaRWRXZWt3elRteGpibHB3V1RKV2FGa3lUblprVnpVd1NXbDNhV0V6Vm1sYVdFcDFXbGhTYkdONU5YQmllVGw2V2xoS01tRlhUbXhaVjA1cVlqTldkV1JET1hWWlZ6RnNZek5DYUZreVZXbFBhVXByV2xkYWFHUlhlREJKYVhkcFlUTldhVnBZU25WYVdGSnNZM2sxY0dKNU9YcGFXRW95WVZkT2JGbFhUbXBpTTFaMVpFTTVlbHBYVG5sYVdGRjFZbTFHZEZwVFNUWkpiVkpzV20xR01XSklVWFJrUnpseVdsYzBkRm95V20xYVJHdHBURU5LY21SWFNteGpiVFZzWkVkV2VreHRiSFpNTTA1c1kyNWFjRmt5Vm1oWk1rNTJaRmMxTUV3elRteGpibHB3V1RKVmRGbFhUbXBpTTFaMVpFTTFkVmxYTVd4SmFtOXBXa2RXYlZsWVZuTmtRMGx6U1cxME1WbHRWbmxpYlZZd1dsaE5kV0ZYT0haak1sWjVaRzFzYWxwWFJtcFpNamt4WW01UmRtTXlWbmxrYld4cVdsTXhhRmt5VG5aa1Z6VXdURzVXY0ZwRFNUWkphbEUxV21wR2FGbFVaRzFNVkZreFRtcEpkRTVFVFRST1V6Rm9UMFJKTUV4VVdUSk9SR2hzV2xSWk5GbHFXbXRhVTBselNXNU9NVmxwU1RaSmJrNDFZek5TYkdKVWNIcGFXRW95WVZkT2JGbFhUbXBpTTFaMVpFUndhMXBYV21oa1YzZ3dUMjFTYkZwdFJqRmlTRkZwWmxFdWF6aFFTV2hzT1ZOQmN6ZEZWelJTZEV0aWNuRk9WSGhQY2xSSVFVNXZWQzFmWkZFdGVESnJjR2wxYVdGVlQyRlVOM1ZJYnpObWFucFRSRlk1WnpWNVIzZElORzFNUlZnNE5FeG9UMEpVYTFBM1ZreGxSekpaZFMwM0xUUkpWV3cxVDJSbWJrTmxlbU4wYURad1JqaERVRU5RYWs4M1NUTkdaRzVGVkUxRGMzSkNPRE5NVTNwV2RVcHJZWFJSY201a1pIZEZXakJLV1RFdFFrVnVOSFZOYjIxbVVVNU9UbDlCV1RWUWMxTnVORkJrVW5CaVlYcFpjVUkxU3pnM1ZqQlFTMUV0V2t3M1VrMURaa2hLYVhscFREQk5TV1pDUmkxRFJuY3dOVUptY2sxRmVXcFNVVzkyYVVaVlpXbE1lRFpHZWxkTlpsTnhUMXA0VEdKbmRHVnJMVEZoVW5WdWVETXpkRGhvYkVKWVRVWkhkV1ppVVdsdlpYSlNaVUZwU2tWMWRGRnVaWE41ZUhWcFNuaERaVTluU1RKVVlsUXlhbEZyTkV4c2R6TkZUblpoVmpCcVNteEphRTlJWTBOUk1EVXlORWxhUXpGbiJ9LCJraW5kIjoiU2VjcmV0IiwibWV0YWRhdGEiOnsiYW5ub3RhdGlvbnMiOnsia3ViZXJuZXRlcy5pby9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImRlZmF1bHQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2UtYWNjb3VudC51aWQiOiI0OWYxYWE3Zi02NTYyLTQzODUtYTgyNC02NjQ4ZWU2OGI2ZGUifSwiY3JlYXRpb25UaW1lc3RhbXAiOiIyMDIzLTA2LTIwVDA4OjExOjQ4WiIsIm1hbmFnZWRGaWVsZHMiOlt7ImFwaVZlcnNpb24iOiJ2MSIsImZpZWxkc1R5cGUiOiJGaWVsZHNWMSIsImZpZWxkc1YxIjp7ImY6ZGF0YSI6eyIuIjp7fSwiZjpjYS5jcnQiOnt9LCJmOm5hbWVzcGFjZSI6e30sImY6dG9rZW4iOnt9fSwiZjptZXRhZGF0YSI6eyJmOmFubm90YXRpb25zIjp7Ii4iOnt9LCJmOmt1YmVybmV0ZXMuaW8vc2VydmljZS1hY2NvdW50Lm5hbWUiOnt9LCJmOmt1YmVybmV0ZXMuaW8vc2VydmljZS1hY2NvdW50LnVpZCI6e319fSwiZjp0eXBlIjp7fX0sIm1hbmFnZXIiOiJrdWJlLWNvbnRyb2xsZXItbWFuYWdlciIsIm9wZXJhdGlvbiI6IlVwZGF0ZSIsInRpbWUiOiIyMDIzLTA2LTIwVDA4OjExOjQ4WiJ9XSwibmFtZSI6ImRlZmF1bHQtdG9rZW4tZ2ZmZDkiLCJuYW1lc3BhY2UiOiJkZWZhdWx0IiwicmVzb3VyY2VWZXJzaW9uIjoiNDQ0IiwidWlkIjoiNTMwMDRjY2MtYThlZC00ZTVlLTk5NDYtYzUyZTgzOTAyYTYxIn0sInR5cGUiOiJrdWJlcm5ldGVzLmlvL3NlcnZpY2UtYWNjb3VudC10b2tlbiJ9XSwia2luZCI6IlNlY3JldExpc3QiLCJtZXRhZGF0YSI6eyJyZXNvdXJjZVZlcnNpb24iOiIzMDIwMyJ9fSwiZW5kT2ZMaXN0Ijp0cnVlfQ=="
}
```
- Add a secret named `my-secret`
```json
{
  "type": "response.watch.v1.secrets.",
  "id": "1",
  "source": "manager",
  "payload": "eyJ0eXBlIjoiQURERUQiLCJvYmplY3QiOnsiYXBpVmVyc2lvbiI6InYxIiwiZGF0YSI6eyJwYXNzd29yZCI6ImMyVmpjbVYwY0dGemMzZHZjbVE9IiwidXNlcm5hbWUiOiJZV1J0YVc0PSJ9LCJraW5kIjoiU2VjcmV0IiwibWV0YWRhdGEiOnsiY3JlYXRpb25UaW1lc3RhbXAiOiIyMDIzLTA2LTIwVDEzOjIxOjI1WiIsIm1hbmFnZWRGaWVsZHMiOlt7ImFwaVZlcnNpb24iOiJ2MSIsImZpZWxkc1R5cGUiOiJGaWVsZHNWMSIsImZpZWxkc1YxIjp7ImY6ZGF0YSI6eyIuIjp7fSwiZjpwYXNzd29yZCI6e30sImY6dXNlcm5hbWUiOnt9fSwiZjp0eXBlIjp7fX0sIm1hbmFnZXIiOiJrdWJlY3RsLWNyZWF0ZSIsIm9wZXJhdGlvbiI6IlVwZGF0ZSIsInRpbWUiOiIyMDIzLTA2LTIwVDEzOjIxOjI1WiJ9XSwibmFtZSI6Im15LXNlY3JldCIsIm5hbWVzcGFjZSI6ImRlZmF1bHQiLCJyZXNvdXJjZVZlcnNpb24iOiIzMTk0OCIsInVpZCI6IjhiMjFkZjAwLWY0MjYtNGIxMC1iMDczLWNmMjNiOTlmYTc3YyJ9LCJ0eXBlIjoiT3BhcXVlIn19"
}
```

- Delete the secret
```json
{
  "type": "response.watch.v1.secrets.",
  "id": "1",
  "source": "manager",
  "payload": "eyJ0eXBlIjoiREVMRVRFRCIsIm9iamVjdCI6eyJhcGlWZXJzaW9uIjoidjEiLCJkYXRhIjp7InBhc3N3b3JkIjoiYzJWamNtVjBjR0Z6YzNkdmNtUT0iLCJ1c2VybmFtZSI6IllXUnRhVzQ9In0sImtpbmQiOiJTZWNyZXQiLCJtZXRhZGF0YSI6eyJjcmVhdGlvblRpbWVzdGFtcCI6IjIwMjMtMDYtMjBUMTM6MjE6MjVaIiwibWFuYWdlZEZpZWxkcyI6W3siYXBpVmVyc2lvbiI6InYxIiwiZmllbGRzVHlwZSI6IkZpZWxkc1YxIiwiZmllbGRzVjEiOnsiZjpkYXRhIjp7Ii4iOnt9LCJmOnBhc3N3b3JkIjp7fSwiZjp1c2VybmFtZSI6e319LCJmOnR5cGUiOnt9fSwibWFuYWdlciI6Imt1YmVjdGwtY3JlYXRlIiwib3BlcmF0aW9uIjoiVXBkYXRlIiwidGltZSI6IjIwMjMtMDYtMjBUMTM6MjE6MjVaIn1dLCJuYW1lIjoibXktc2VjcmV0IiwibmFtZXNwYWNlIjoiZGVmYXVsdCIsInJlc291cmNlVmVyc2lvbiI6IjMyMDA1IiwidWlkIjoiOGIyMWRmMDAtZjQyNi00YjEwLWIwNzMtY2YyM2I5OWZhNzdjIn0sInR5cGUiOiJPcGFxdWUifX0="
}
```